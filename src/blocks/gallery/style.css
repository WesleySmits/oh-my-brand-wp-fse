/**
 * Gallery Block - Frontend styles.
 *
 * @package theme-oh-my-brand
 */

.wp-block-theme-oh-my-brand-gallery.acf-gallery-wrapper {
	overflow: hidden;
	position: relative;
	width: 100%;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery {
	--visible-images: 3; /* Fallback */
	--block-gap: var(--acf-block-gap, 0px); /* Fallback */
	--acf-gallery-gap: var(--block-gap, 0px); /* Ensure unit is included */
	display: flex;
	align-items: center;
	overflow-x: auto;
	scroll-snap-type: x mandatory;
	scroll-behavior: smooth;
	gap: var(--acf-block-gap, 0);
	padding: var(--wp--preset--spacing--padding, 0);
	margin: var(--wp--preset--spacing--margin, 0);
	background-color: var(--wp--preset--color--background, transparent);
	-webkit-overflow-scrolling: touch;
	scroll-padding: 0;

	/* Hide scrollbar while keeping scroll functionality */
	scrollbar-width: none; /* Firefox */
	-ms-overflow-style: none; /* IE/Edge */

	--item-width: calc(100% / var(--visible-images));
	--gap-offset: calc((var(--acf-gallery-gap) * (var(--visible-images) - 1)) / var(--visible-images));
	--gallery-item-width: calc(var(--item-width) - var(--gap-offset));
}

/* Hide scrollbar for Chrome/Safari/Opera */
.wp-block-theme-oh-my-brand-gallery .acf-gallery::-webkit-scrollbar {
	display: none;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-item {
	flex: 0 0 var(--gallery-item-width);
	scroll-snap-align: center;
	display: flex;
	justify-content: center;
	align-items: flex-start;
}

@media (width <= 30rem) {
	.wp-block-theme-oh-my-brand-gallery .acf-gallery-item {
		scroll-snap-align: start;
	}
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-inner {
	position: relative;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-item img {
	width: 100%;
	height: auto;
	object-fit: cover;
	border-radius: 5px;
}

/* Navigation Buttons */
.wp-block-theme-oh-my-brand-gallery .acf-gallery-prev,
.wp-block-theme-oh-my-brand-gallery .acf-gallery-next {
	position: absolute;
	top: 50%;
	transform: translateY(-50%);
	background: rgb(0 0 0 / 50%);
	color: white;
	border: none;
	padding: 10px 15px;
	cursor: pointer;
	font-size: 24px;
	z-index: 10;
	display: none;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-prev:focus,
.wp-block-theme-oh-my-brand-gallery .acf-gallery-next:focus {
	outline: 2px solid var(--color-primary, #5344f4);
	outline-offset: 2px;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-prev {
	left: 10px;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-next {
	right: 10px;
}

/* Focus-visible states */
.wp-block-theme-oh-my-brand-gallery .acf-gallery-prev:focus-visible,
.wp-block-theme-oh-my-brand-gallery .acf-gallery-next:focus-visible {
	outline: 2px solid var(--wp--preset--color--primary, #06c);
	outline-offset: 2px;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-item:focus-visible {
	outline: 2px solid var(--wp--preset--color--primary, #06c);
	outline-offset: 2px;
	border-radius: 5px;
}

/* Lightbox link styles */
.wp-block-theme-oh-my-brand-gallery .acf-gallery-item__link {
	display: block;
	width: 100%;
	cursor: zoom-in;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-item__link:focus-visible {
	outline: 2px solid var(--wp--preset--color--primary, #06c);
	outline-offset: 2px;
	border-radius: 5px;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-item__link img {
	transition: transform 200ms ease;
}

.wp-block-theme-oh-my-brand-gallery .acf-gallery-item__link:hover img {
	transform: scale(1.02);
}

@media (prefers-reduced-motion: reduce) {
	.wp-block-theme-oh-my-brand-gallery .acf-gallery-item__link img {
		transition: none;
	}

	.wp-block-theme-oh-my-brand-gallery .acf-gallery-item__link:hover img {
		transform: none;
	}
}

/* Respect user motion preferences */
@media (prefers-reduced-motion: reduce) {
	.wp-block-theme-oh-my-brand-gallery .acf-gallery {
		scroll-behavior: auto;
	}
}

/* Live region for screen reader announcements */
.wp-block-theme-oh-my-brand-gallery .acf-gallery-live {
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0, 0, 0, 0);
	white-space: nowrap;
	border: 0;
}

/**
 * CSS Scroll Markers for gallery pagination indicators.
 *
 * Uses the new CSS ::scroll-marker pseudo-elements for native
 * scroll position indicators. Falls back gracefully in
 * browsers that don't support this feature.
 *
 * @see https://developer.chrome.com/docs/css-ui/scroll-driven-animations
 */
@supports (scroll-marker-group: after) {
	.wp-block-theme-oh-my-brand-gallery .acf-gallery {
		/* Enable scroll markers on the gallery container */
		scroll-marker-group: after;
	}

	/* Container for scroll markers */
	.wp-block-theme-oh-my-brand-gallery .acf-gallery::scroll-marker-group {
		display: flex;
		justify-content: center;
		gap: 0.5rem;
		padding-block: 1rem;
	}

	/* Individual scroll markers (dots) */
	.wp-block-theme-oh-my-brand-gallery .acf-gallery-item::scroll-marker {
		content: '';
		display: inline-block;
		width: 10px;
		height: 10px;
		border-radius: 50%;
		background-color: var(--wp--preset--color--contrast, #333);
		opacity: 30%;
		transition:
			opacity 200ms ease,
			transform 200ms ease;
		cursor: pointer;
	}

	/* Active scroll marker state */
	.wp-block-theme-oh-my-brand-gallery .acf-gallery-item::scroll-marker:target-current {
		opacity: 100%;
		transform: scale(1.2);
	}

	/* Hover state for scroll markers */
	.wp-block-theme-oh-my-brand-gallery .acf-gallery-item::scroll-marker:hover {
		opacity: 70%;
	}

	/* Focus-visible state for keyboard accessibility */
	.wp-block-theme-oh-my-brand-gallery .acf-gallery-item::scroll-marker:focus-visible {
		outline: 2px solid var(--wp--preset--color--primary, #06c);
		outline-offset: 2px;
	}

	/* Reduced motion preference */
	@media (prefers-reduced-motion: reduce) {
		.wp-block-theme-oh-my-brand-gallery .acf-gallery-item::scroll-marker {
			transition: none;
		}
	}
}
